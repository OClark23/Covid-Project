import React, { Component } from 'react';
import api, { getPatientById } from '../api';
import styled from 'styled-components';
import { Link } from 'react-router-dom';
import './itemPatient.css';
import {FaXRay,  FaHospitalUser, FaInfoCircle} from 'react-icons/fa';
  
class ItemInfo extends Component{
    constructor(props){
        super(props);
        this.state = {
            _id: '',
            PATIENT_ID: '',
            SEX: '',
            AGE: '',
            ZIP: '',
            IMAGES: []
        };
       
    }

    componentDidMount() {
      const patientID = this.props.match.params.id;
      if(patientID){
        this.fetchSinglePatient(patientID).then(resp => {
          console.log("Response: ", resp);
          const { patient } = resp.data;
          let images = resp.data.patient_image.map(image => {
            return image.PNG_FILENAME;
          })
          this.setState({ ...patient });
        this.setState({IMAGES: images});
      });
      }
    }

    fetchSinglePatient = patientID => {
      return api
        .getPatientById(patientID)
        .then(resp => {
          console.log('getPatientById: resp');
          console.log(resp);
          return resp;
        })
        .catch(err => {
          console.error(`ERROR in 'fetchSinglePatient': ${err}`);
          console.error(err);
          return err;
        });
    };

render(){
    const {_id, PATIENT_ID, SEX, AGE, ZIP, IMAGES} = this.state;

    console.log("State:", this.state);

    return (
        PATIENT_ID && (
          <div className="ItemPage">
            <div>
            <svg width="348" height="51" viewBox="0 0 348 51" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M9 14.1562V32.0938H17.9688C19.1979 32.0938 20.3542 31.8646 21.4375 31.4062C22.5208 30.9271 23.4688 30.2812 24.2812 29.4688C25.0938 28.6562 25.7292 27.7083 26.1875 26.625C26.6667 25.5208 26.9062 24.3542 26.9062 23.125C26.9062 21.8958 26.6667 20.7396 26.1875 19.6562C25.7292 18.5521 25.0938 17.5938 24.2812 16.7812C23.4688 15.9688 22.5208 15.3333 21.4375 14.875C20.3542 14.3958 19.1979 14.1562 17.9688 14.1562H9ZM9 50H0.03125V5.1875H17.9688C19.6146 5.1875 21.1979 5.40625 22.7188 5.84375C24.2396 6.26042 25.6562 6.86458 26.9688 7.65625C28.3021 8.42708 29.5104 9.36458 30.5938 10.4688C31.6979 11.5521 32.6354 12.7604 33.4062 14.0938C34.1979 15.4271 34.8021 16.8542 35.2188 18.375C35.6562 19.8958 35.875 21.4792 35.875 23.125C35.875 25.5833 35.4062 27.9062 34.4688 30.0938C33.5312 32.2604 32.25 34.1562 30.625 35.7812C29 37.4062 27.0938 38.6875 24.9062 39.625C22.7396 40.5625 20.4271 41.0312 17.9688 41.0312H9V50ZM72.6562 50H70.5938L67.2812 45.4062C66.4688 46.1354 65.6042 46.8229 64.6875 47.4688C63.7917 48.0938 62.8438 48.6458 61.8438 49.125C60.8438 49.5833 59.8125 49.9479 58.75 50.2188C57.7083 50.4896 56.6458 50.625 55.5625 50.625C53.2083 50.625 50.9896 50.2292 48.9062 49.4375C46.8438 48.6458 45.0312 47.5 43.4688 46C41.9271 44.4792 40.7083 42.625 39.8125 40.4375C38.9167 38.25 38.4688 35.7604 38.4688 32.9688C38.4688 30.3646 38.9167 27.9792 39.8125 25.8125C40.7083 23.625 41.9271 21.75 43.4688 20.1875C45.0312 18.625 46.8438 17.4167 48.9062 16.5625C50.9896 15.6875 53.2083 15.25 55.5625 15.25C56.6458 15.25 57.7188 15.3854 58.7812 15.6562C59.8438 15.9271 60.875 16.3021 61.875 16.7812C62.875 17.2604 63.8229 17.8229 64.7188 18.4688C65.6354 19.1146 66.4896 19.8125 67.2812 20.5625L70.5938 16.5938H72.6562V50ZM64.0625 32.9688C64.0625 31.8021 63.8333 30.6771 63.375 29.5938C62.9375 28.4896 62.3333 27.5208 61.5625 26.6875C60.7917 25.8333 59.8854 25.1562 58.8438 24.6562C57.8229 24.1354 56.7292 23.875 55.5625 23.875C54.3958 23.875 53.2917 24.0729 52.25 24.4688C51.2292 24.8646 50.3333 25.4479 49.5625 26.2188C48.8125 26.9896 48.2188 27.9479 47.7812 29.0938C47.3438 30.2188 47.125 31.5104 47.125 32.9688C47.125 34.4271 47.3438 35.7292 47.7812 36.875C48.2188 38 48.8125 38.9479 49.5625 39.7188C50.3333 40.4896 51.2292 41.0729 52.25 41.4688C53.2917 41.8646 54.3958 42.0625 55.5625 42.0625C56.7292 42.0625 57.8229 41.8125 58.8438 41.3125C59.8854 40.7917 60.7917 40.1146 61.5625 39.2812C62.3333 38.4271 62.9375 37.4583 63.375 36.375C63.8333 35.2708 64.0625 34.1354 64.0625 32.9688ZM95.9688 50C93.9062 50 91.9688 49.6146 90.1562 48.8438C88.3438 48.0521 86.75 46.9792 85.375 45.625C84.0208 44.25 82.9479 42.6562 82.1562 40.8438C81.3854 39.0312 81 37.0938 81 35.0312V25.0938H76.8438V16.5938H81V3.21875H89.5V16.5938H102.438V25.0938H89.5V35.0312C89.5 35.9271 89.6667 36.7708 90 37.5625C90.3333 38.3333 90.7917 39.0104 91.375 39.5938C91.9583 40.1771 92.6458 40.6458 93.4375 41C94.2292 41.3333 95.0729 41.5 95.9688 41.5H102.438V50H95.9688ZM117.312 7.4375C117.312 8.22917 117.156 8.96875 116.844 9.65625C116.552 10.3438 116.146 10.9479 115.625 11.4688C115.104 11.9688 114.49 12.375 113.781 12.6875C113.094 12.9792 112.354 13.125 111.562 13.125C110.771 13.125 110.021 12.9792 109.312 12.6875C108.625 12.375 108.021 11.9688 107.5 11.4688C107 10.9479 106.594 10.3438 106.281 9.65625C105.99 8.96875 105.844 8.22917 105.844 7.4375C105.844 6.66667 105.99 5.9375 106.281 5.25C106.594 4.54167 107 3.9375 107.5 3.4375C108.021 2.91667 108.625 2.51042 109.312 2.21875C110.021 1.90625 110.771 1.75 111.562 1.75C112.354 1.75 113.094 1.90625 113.781 2.21875C114.49 2.51042 115.104 2.91667 115.625 3.4375C116.146 3.9375 116.552 4.54167 116.844 5.25C117.156 5.9375 117.312 6.66667 117.312 7.4375ZM115.844 50H107.25V16.5312H115.844V50ZM135.688 41.8125C136.021 41.9167 136.354 41.9896 136.688 42.0312C137.021 42.0521 137.354 42.0625 137.688 42.0625C138.521 42.0625 139.323 41.9479 140.094 41.7188C140.865 41.4896 141.583 41.1667 142.25 40.75C142.938 40.3125 143.542 39.7917 144.062 39.1875C144.604 38.5625 145.042 37.875 145.375 37.125L151.625 43.4062C150.833 44.5312 149.917 45.5417 148.875 46.4375C147.854 47.3333 146.74 48.0938 145.531 48.7188C144.344 49.3438 143.083 49.8125 141.75 50.125C140.438 50.4583 139.083 50.625 137.688 50.625C135.333 50.625 133.115 50.1875 131.031 49.3125C128.969 48.4375 127.156 47.2188 125.594 45.6562C124.052 44.0938 122.833 42.2396 121.938 40.0938C121.042 37.9271 120.594 35.5521 120.594 32.9688C120.594 30.3229 121.042 27.9062 121.938 25.7188C122.833 23.5312 124.052 21.6667 125.594 20.125C127.156 18.5833 128.969 17.3854 131.031 16.5312C133.115 15.6771 135.333 15.25 137.688 15.25C139.083 15.25 140.448 15.4167 141.781 15.75C143.115 16.0833 144.375 16.5625 145.562 17.1875C146.771 17.8125 147.896 18.5833 148.938 19.5C149.979 20.3958 150.896 21.4062 151.688 22.5312L135.688 41.8125ZM140.062 24.2188C139.667 24.0729 139.271 23.9792 138.875 23.9375C138.5 23.8958 138.104 23.875 137.688 23.875C136.521 23.875 135.417 24.0938 134.375 24.5312C133.354 24.9479 132.458 25.5521 131.688 26.3438C130.938 27.1354 130.344 28.0938 129.906 29.2188C129.469 30.3229 129.25 31.5729 129.25 32.9688C129.25 33.2812 129.26 33.6354 129.281 34.0312C129.323 34.4271 129.375 34.8333 129.438 35.25C129.521 35.6458 129.615 36.0312 129.719 36.4062C129.823 36.7812 129.958 37.1146 130.125 37.4062L140.062 24.2188ZM164.531 50H156V16.5312H158.062L160.875 19.7812C162.25 18.5312 163.802 17.5729 165.531 16.9062C167.281 16.2188 169.104 15.875 171 15.875C173.042 15.875 174.969 16.2708 176.781 17.0625C178.594 17.8333 180.177 18.9062 181.531 20.2812C182.885 21.6354 183.948 23.2292 184.719 25.0625C185.51 26.875 185.906 28.8125 185.906 30.875V50H177.375V30.875C177.375 30 177.208 29.1771 176.875 28.4062C176.542 27.6146 176.083 26.9271 175.5 26.3438C174.917 25.7604 174.24 25.3021 173.469 24.9688C172.698 24.6354 171.875 24.4688 171 24.4688C170.104 24.4688 169.26 24.6354 168.469 24.9688C167.677 25.3021 166.99 25.7604 166.406 26.3438C165.823 26.9271 165.365 27.6146 165.031 28.4062C164.698 29.1771 164.531 30 164.531 30.875V50ZM208.344 50C206.281 50 204.344 49.6146 202.531 48.8438C200.719 48.0521 199.125 46.9792 197.75 45.625C196.396 44.25 195.323 42.6562 194.531 40.8438C193.76 39.0312 193.375 37.0938 193.375 35.0312V25.0938H189.219V16.5938H193.375V3.21875H201.875V16.5938H214.812V25.0938H201.875V35.0312C201.875 35.9271 202.042 36.7708 202.375 37.5625C202.708 38.3333 203.167 39.0104 203.75 39.5938C204.333 40.1771 205.021 40.6458 205.812 41C206.604 41.3333 207.448 41.5 208.344 41.5H214.812V50H208.344ZM247.438 50H238.469V5.1875H247.438V50ZM263.406 50H254.875V16.5312H256.938L259.75 19.7812C261.125 18.5312 262.677 17.5729 264.406 16.9062C266.156 16.2188 267.979 15.875 269.875 15.875C271.917 15.875 273.844 16.2708 275.656 17.0625C277.469 17.8333 279.052 18.9062 280.406 20.2812C281.76 21.6354 282.823 23.2292 283.594 25.0625C284.385 26.875 284.781 28.8125 284.781 30.875V50H276.25V30.875C276.25 30 276.083 29.1771 275.75 28.4062C275.417 27.6146 274.958 26.9271 274.375 26.3438C273.792 25.7604 273.115 25.3021 272.344 24.9688C271.573 24.6354 270.75 24.4688 269.875 24.4688C268.979 24.4688 268.135 24.6354 267.344 24.9688C266.552 25.3021 265.865 25.7604 265.281 26.3438C264.698 26.9271 264.24 27.6146 263.906 28.4062C263.573 29.1771 263.406 30 263.406 30.875V50ZM301.219 50H292.688V25.0312H288.531V16.5312H292.688V14.9375C292.688 12.875 293.073 10.9375 293.844 9.125C294.635 7.3125 295.708 5.73958 297.062 4.40625C298.438 3.05208 300.031 1.98958 301.844 1.21875C303.656 0.427083 305.594 0.03125 307.656 0.03125H314.062V8.53125H307.656C306.74 8.53125 305.885 8.69792 305.094 9.03125C304.323 9.34375 303.646 9.79167 303.062 10.375C302.5 10.9375 302.052 11.6146 301.719 12.4062C301.385 13.1771 301.219 14.0208 301.219 14.9375V16.5312H311.688V25.0312H301.219V50ZM347.469 32.9688C347.469 35.4688 347.021 37.8021 346.125 39.9688C345.229 42.1146 344.01 43.9792 342.469 45.5625C340.927 47.125 339.115 48.3646 337.031 49.2812C334.969 50.1771 332.75 50.625 330.375 50.625C328.021 50.625 325.802 50.1771 323.719 49.2812C321.656 48.3646 319.844 47.125 318.281 45.5625C316.74 43.9792 315.521 42.1146 314.625 39.9688C313.729 37.8021 313.281 35.4688 313.281 32.9688C313.281 30.4271 313.729 28.0729 314.625 25.9062C315.521 23.7396 316.74 21.875 318.281 20.3125C319.844 18.7292 321.656 17.4896 323.719 16.5938C325.802 15.6979 328.021 15.25 330.375 15.25C332.75 15.25 334.969 15.6771 337.031 16.5312C339.115 17.3646 340.927 18.5625 342.469 20.125C344.01 21.6667 345.229 23.5312 346.125 25.7188C347.021 27.8854 347.469 30.3021 347.469 32.9688ZM338.875 32.9688C338.875 31.5938 338.646 30.3542 338.188 29.25C337.75 28.125 337.146 27.1667 336.375 26.375C335.604 25.5625 334.698 24.9479 333.656 24.5312C332.635 24.0938 331.542 23.875 330.375 23.875C329.208 23.875 328.104 24.0938 327.062 24.5312C326.042 24.9479 325.146 25.5625 324.375 26.375C323.625 27.1667 323.031 28.125 322.594 29.25C322.156 30.3542 321.938 31.5938 321.938 32.9688C321.938 34.2604 322.156 35.4583 322.594 36.5625C323.031 37.6667 323.625 38.625 324.375 39.4375C325.146 40.25 326.042 40.8958 327.062 41.375C328.104 41.8333 329.208 42.0625 330.375 42.0625C331.542 42.0625 332.635 41.8438 333.656 41.4062C334.698 40.9688 335.604 40.3542 336.375 39.5625C337.146 38.7708 337.75 37.8125 338.188 36.6875C338.646 35.5625 338.875 34.3229 338.875 32.9688Z" fill="white"/>
</svg>

</div>

            <div className="ItemContainer">
              <div className="ItemPatient" style={{ minHeight:"500px", minWidth:"450px"}}>
                <h1 className="card-title"><FaHospitalUser size={34} color={"green"}/>  Patient</h1>
                <div className="ItemText">
                  <h4><strong>Patient ID:</strong></h4>
                  <h4>{PATIENT_ID}</h4>
                </div>
                <div className="ItemText">
                  <h4><strong>Sex:</strong></h4>
                  <h4>{SEX}</h4>
                </div>
                <div className="ItemText">
                  <h4><strong>Age:</strong></h4>
                  <h4>{AGE}</h4>
                </div>
                <div className="ItemText">
                  <h4><strong>Zip Code:</strong></h4>
                  <h4>{ZIP}</h4>
                </div>
              </div>
              <div className="ItemPatient">
                <h1 className="card-title"><FaXRay size={34}/>  Exam History</h1>
                <div className="previewExam">
                <Link to={`/item/itemPatientExam/${_id}`}>   
                <img style={{ minHeight:"320px", minWidth:"320px"}}  styl src={`https://ohif-hack-diversity-covid.s3.amazonaws.com/covid-png/${IMAGES[0]}`}>
                </img></Link>
                <Link to={`/item/itemPatientExam/${_id}`}><h4 className="examLink">Open Exam Details</h4> </Link>
                </div>
              </div>
            </div>
            
            </div>

            
    ));
}
};
export default ItemInfo;